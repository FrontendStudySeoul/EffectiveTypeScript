## 46: 타입 선언과 관련된 세 가지 버전 이해하기

> 타입스크립트는 의존성 문제를 해결해주기보다는 의존성 관리를 오히려 더 복잡하게 만든다.

타입스크립트를 사용하면 아래 세가지 상황을 추가로 고려해야한다.

1. 라이브러리의 버전
2. 타입 선언(@types)의 버전
3. 타입스크립트의 버전

### 타입스크립트에서 의존성을 사용하는 방식
- 라이브러리를 dependencies로 설치
- 타입 정보는 devDependencies로 설치

``` bash
npm install react
> react@16.8.6

npm install --save-dev @types/react
> @types/react@16.8.19: 리액트의 16.8버전의 API의 타입 선언
```

- 패치 버전은 일치하지 않는다: 보통 라이브러리 자체보다 타입 선언에 더 많은 업데이트가 있기 때문이다.

<br />

하지만 실제 라이브러리와 타입 정보의 버전이 별도로 관리되는 방식에는 문제점이 있다.

### 1. 라이브러리 버전 > 타입 선언 버전
> 라이브러리를 업데이트 했지만, 타입 선언은 업데이트하지 않은 경우
   - 업데이트 관련 새로운 기능을 사용하려고하면 타입 오류가 발생한다.
   - 하위 호환성이 깨지는 변경이 있으면 코드가 타입 체커를 통과하더라도 런타임에 오류가 발생
#### 해결책
  - 타입 선언을 업데이트
  - 타입 선언 버전이 준비되지 않는 경우
    1. 보강 기법을 활용하여 새 함수와 메서드의 타입 정보를 프로젝트 자체에 추가
    2. 타입 선언의 업데이트를 직접 작성항고 공개하여 커뮤니티에 기여
      
### 2. 라이브러리 버전 < 타입 선언 버전
> 라이브러리보다 타입 선언의 버전이 최신인 경우
   - 타입 정보 없이 라이브러리를 사용하다가 타입 선언을 설치하려고 할 때 발생
   - 타입체커는 최신 API를 기준으로 코드를 검사하지만 런타임에서는 과거 버전을 사용
#### 해결책
   - 라이브러리의 버전을 올리거나 타입 선언의 버전을 내림
    
### 3. 프로젝트에서 사용하는 타입스크립트 버전 < 라이브러리에서 필요한 타입스크립트의 버전
> 프로젝트에서 사용하는 타입스크립트 버전보다 라이브러리에서 필요한 타입스크립트의 버전이 최신인 경우
#### 해결책
   - 프로젝트의 타입스크립트 버전을 올린다
   - 라이브러리의 타입 선언의 버전을 내린다
  
     ``` bash
     npm install --save-dev @types/lodash@ts3.1
     ```

  
### 4. @types 의존성이 중복
  - 전역 네임스페이스에 있는 타입 선언 모듈이면 문제가 발생
  - 전역 네임 스페이스에 타입 선언이 존재하면 중복된 선언, 또는 선언이 병합될 수 없다는 오류가 발생
    - `npm ls @types/foo`를 실행하여 타입 선언 중복이 어디서 발생했는지 추적 가능



